<!DOCTYPE html>
<html lang="de">

	<head>
		<meta charset="utf-8">
		<meta name="author" content="Stefanie Zahn">
		<title> Spacetacular - a three.js game </title>
		<link href="style.css" rel="stylesheet" type="text/css">
	</head>

	<body>
		<script src="js/three.min.js"></script>
		<!-- Kamerasteuerung per Maus zu Debugzwecken; in offizieller three.js Bibliothek enthalten -->
		<script src="js/OrbitControls.js"></script>

		<script>
			//globale Variabeln
			// aktuelles Datum in Millisek.
			var startTime = Date.now();

			//Szene
			var scene = new THREE.Scene();

			//Kamera
			var WIDTH = window.innerWidth;
			var HEIGHT = window.innerHeight;
			var camera = new THREE.PerspectiveCamera(45, WIDTH/HEIGHT, 0.1, 10000);
			scene.add(camera);
			//Kamera weiter in Richtung +z setzen, da sich Szene am Ursprung abspielen soll
			camera.position.z = 100;

			//Renderer
			var renderer = new THREE.WebGLRenderer();
			renderer.setSize(WIDTH, HEIGHT);
			document.body.appendChild(renderer.domElement);

			//Einbindung der Kamerasteuerung
			var controls = new THREE.OrbitControls(camera, render);

			//alle Meteoriten
			var meteorits  = [];

			for ( i = 0; i < 20; i++) {
				var geometry = new THREE.BoxGeometry(10, 10, 10);
				var material = new THREE.MeshBasicMaterial({color: 0x6a6a6a, wireframe: true});
				var met = new THREE.Mesh(geometry, material);

				met.position.z = (Math.random() * (-1000 - (1000)) + (1000));
				met.position.x = (Math.random() * (85 - (-85)) + (-85));
				met.position.y = (Math.random() * (85 - (-85)) + (-85));

				scene.add(met);
				meteorits.push(met);
			}

			//Sternenhimmel
			var sphere = new THREE.SphereGeometry( 1, 32, 32 );
			var starmat = new THREE.MeshBasicMaterial( { color: 0xffffff, specular: 0xffffff, shininess: 50 } );
			var stars = [];

			for (var i = 0; i < 5000; i ++) {

				var star = new THREE.Mesh(sphere, starmat);

				star.position.x = 3000 * (2.0 * Math.random() - 1.0);
				star.position.y = 3000 * (2.0 * Math.random() - 1.0);
				star.position.z = (Math.random() * (100 - (-3000)) + (-3000));

				scene.add(star);
				stars.push(star);
			}

				//Meteoriten bewegen
			function meteorit() {
				for (i = 0; i < meteorits.length; i++) {
				//Meteorit bewegen um x- und y-Achse; z-Position
				meteorits[i].rotation.x += 0.01;
				meteorits[i].rotation.y += 0.01;
				meteorits[i].position.z += 2.5;

				//Meteoriten verschieben wenn hinter Kamera
				if (meteorits[i].position.z >= 100) {
					meteorits[i].position.z = (Math.random() * (200 - (-200)) + (-200)) -1000;
					meteorits[i].position.x = (Math.random() * (85 - (-85)) + (-85));
					meteorits[i].position.y = (Math.random() * (85 - (-85)) + (-85));
					}

					//schwingende Bewegung mit Hilfe der Zeitdifferenz
					//meteorits[i].position.x += Math.random() * 8 * Math.sin(timeDelta * 0.001);

					//Position Debug
					//console.log(meteorits[i].position.x);
					}
				}


			//Schleifenfunktion zum rendern; 60fps
			var render = function() {
				requestAnimationFrame(render);

				timeDelta = Date.now() - startTime;

				meteorit();

				//Sternbewegung; Funktion gleich zu Meteoriten
				for (i = 0; i < stars.length; i++) {
					//Sterne bewegen
					stars[i].position.z += 0.5;

					//Sterne verschieben wenn hinter Kamera
					if (stars[i].position.z >= 100) {
						stars[i].position.x = 3000 * (2.0 * Math.random() - 1.0);
						stars[i].position.y = 3000 * (2.0 * Math.random() - 1.0);
						stars[i].position.z = (Math.random() * (100 - (-3000)) + (-3000));
					}

				}

				renderer.render(scene, camera);
			};

			render();

		</script>
	</body>

</html>
